{"version":3,"sources":["../../../src/intrinsics/fb-www/fb-mocks.js"],"names":["createFbMocks","t","fbMagicGlobalFunctions","fbMagicGlobalObjects","createBabelHelpers","realm","global","babelHelpersValue","intrinsics","ObjectPrototype","objectAssign","Object","objectCreate","inheritsValue","undefined","context","subClass","superClass","objectAssignCall","$Call","superClassPrototype","objectCreateCall","newPrototype","Set","$DefineOwnProperty","value","writable","enumerable","configurable","intrinsicName","createObjectWithoutProperties","obj","keys","removeKeys","key","add","newObject","ObjectCreate","propName","binding","properties","has","descriptor","objectWithoutPropertiesValue","mightBeObject","values","isTop","isPartialObject","temporalArgs","temporalConfig","skipInvariant","isPure","createTemporalFromBuildFunction","methodNode","objNode","propRemoveNode","callExpression","template","makeSimple","taggedTemplateLiteralLooseValue","strings","raw","functionBind","FunctionPrototype","refuseSerialization","createMagicGlobalFunction","functionName","args","val","_args","identifier","createMagicGlobalObject","objectName","globalObject","createAbstractObject","kind","createBootloader","bootloader","loadModules","$Realm","generator","memberExpression","false"],"mappings":"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","file":"fb-mocks.js","sourcesContent":["/**\n * Copyright (c) 2017-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n/* @flow */\n\nimport type { Realm } from \"../../realm.js\";\nimport { ValuesDomain } from \"../../domains/index.js\";\nimport {\n  ArrayValue,\n  AbstractValue,\n  FunctionValue,\n  AbstractObjectValue,\n  NativeFunctionValue,\n  ObjectValue,\n  StringValue,\n  NumberValue,\n} from \"../../values/index.js\";\nimport { Create } from \"../../singletons.js\";\nimport { Get } from \"../../methods/index.js\";\nimport * as t from \"babel-types\";\nimport invariant from \"../../invariant\";\nimport { Properties } from \"../../singletons.js\";\nimport { forEachArrayValue } from \"../../react/utils.js\";\n\nconst fbMagicGlobalFunctions = [\n  \"asset\",\n  \"cx\",\n  \"cssVar\",\n  \"csx\",\n  \"errorDesc\",\n  \"errorHelpCenterID\",\n  \"errorSummary\",\n  \"gkx\",\n  \"glyph\",\n  \"ifRequired\",\n  \"ix\",\n  \"fbglyph\",\n  \"requireWeak\",\n  \"xuiglyph\",\n];\n\nconst fbMagicGlobalObjects = [\"JSResource\", \"fbt\"];\n\nfunction createBabelHelpers(realm: Realm, global: ObjectValue | AbstractObjectValue) {\n  let babelHelpersValue = new ObjectValue(realm, realm.intrinsics.ObjectPrototype, `babelHelpers`, true);\n  let objectAssign = Get(realm, realm.intrinsics.Object, \"assign\");\n  let objectCreate = Get(realm, realm.intrinsics.Object, \"create\");\n\n  //babelHelpers.objectWithoutProperties\n  let inheritsValue = new NativeFunctionValue(realm, undefined, `inherits`, 2, (context, [subClass, superClass]) => {\n    invariant(objectAssign instanceof NativeFunctionValue);\n    let objectAssignCall = objectAssign.$Call;\n    invariant(objectAssignCall !== undefined);\n    objectAssignCall(realm.intrinsics.undefined, [subClass, superClass]);\n\n    invariant(superClass instanceof ObjectValue);\n    let superClassPrototype = Get(realm, superClass, \"prototype\");\n    invariant(objectCreate instanceof NativeFunctionValue);\n    let objectCreateCall = objectCreate.$Call;\n    invariant(typeof objectCreateCall === \"function\");\n    let newPrototype = objectCreateCall(realm.intrinsics.undefined, [superClassPrototype]);\n\n    invariant(subClass instanceof ObjectValue);\n    invariant(newPrototype instanceof ObjectValue);\n    Properties.Set(realm, subClass, \"prototype\", newPrototype, true);\n    Properties.Set(realm, newPrototype, \"constructor\", subClass, true);\n    Properties.Set(realm, subClass, \"__superConstructor__\", superClass, true);\n\n    return superClass;\n  });\n  babelHelpersValue.$DefineOwnProperty(\"inherits\", {\n    value: inheritsValue,\n    writable: false,\n    enumerable: false,\n    configurable: true,\n  });\n  inheritsValue.intrinsicName = `babelHelpers.inherits`;\n\n  const createObjectWithoutProperties = (obj: ObjectValue, keys: ArrayValue) => {\n    let removeKeys = new Set();\n    forEachArrayValue(realm, keys, key => {\n      if (key instanceof StringValue || key instanceof NumberValue) {\n        removeKeys.add(key.value);\n      }\n    });\n    let newObject = Create.ObjectCreate(realm, realm.intrinsics.ObjectPrototype);\n    for (let [propName, binding] of obj.properties) {\n      if (!removeKeys.has(propName)) {\n        if (binding && binding.descriptor && binding.descriptor.enumerable) {\n          let value = Get(realm, obj, propName);\n          Properties.Set(realm, newObject, propName, value, true);\n        }\n      }\n    }\n    return newObject;\n  };\n\n  //babelHelpers.objectWithoutProperties\n  let objectWithoutPropertiesValue = new NativeFunctionValue(\n    realm,\n    undefined,\n    `objectWithoutProperties`,\n    2,\n    (context, [obj, keys]) => {\n      invariant(obj instanceof ObjectValue || obj instanceof AbstractObjectValue || obj instanceof AbstractValue);\n      invariant(keys instanceof ArrayValue);\n      if (obj.mightBeObject() && ((obj instanceof AbstractValue && obj.values.isTop()) || obj.isPartialObject())) {\n        let temporalArgs = [objectWithoutPropertiesValue, obj, keys];\n        let temporalConfig = { skipInvariant: true, isPure: true };\n        let value = AbstractValue.createTemporalFromBuildFunction(\n          realm,\n          ObjectValue,\n          temporalArgs,\n          ([methodNode, objNode, propRemoveNode]) => {\n            return t.callExpression(methodNode, [objNode, propRemoveNode]);\n          },\n          temporalConfig\n        );\n        invariant(value instanceof AbstractObjectValue);\n        if (obj instanceof ObjectValue) {\n          let template = createObjectWithoutProperties(obj, keys);\n          value.values = new ValuesDomain(template);\n        }\n        // as we are returning an abstract object, we mark it as simple\n        value.makeSimple();\n        return value;\n      } else {\n        invariant(obj instanceof ObjectValue);\n        return createObjectWithoutProperties(obj, keys);\n      }\n    }\n  );\n  babelHelpersValue.$DefineOwnProperty(\"objectWithoutProperties\", {\n    value: objectWithoutPropertiesValue,\n    writable: false,\n    enumerable: false,\n    configurable: true,\n  });\n  objectWithoutPropertiesValue.intrinsicName = `babelHelpers.objectWithoutProperties`;\n\n  //babelHelpers.taggedTemplateLiteralLoose\n  let taggedTemplateLiteralLooseValue = new NativeFunctionValue(\n    realm,\n    undefined,\n    `taggedTemplateLiteralLoose`,\n    2,\n    (context, [strings, raw]) => {\n      invariant(strings instanceof ObjectValue);\n      Properties.Set(realm, strings, \"raw\", raw, true);\n      return strings;\n    }\n  );\n  babelHelpersValue.$DefineOwnProperty(\"taggedTemplateLiteralLoose\", {\n    value: taggedTemplateLiteralLooseValue,\n    writable: false,\n    enumerable: false,\n    configurable: true,\n  });\n  taggedTemplateLiteralLooseValue.intrinsicName = `babelHelpers.taggedTemplateLiteralLoose`;\n\n  //babelHelpers.extends & babelHelpers._extends\n  babelHelpersValue.$DefineOwnProperty(\"extends\", {\n    value: objectAssign,\n    writable: true,\n    enumerable: true,\n    configurable: true,\n  });\n\n  babelHelpersValue.$DefineOwnProperty(\"_extends\", {\n    value: objectAssign,\n    writable: true,\n    enumerable: true,\n    configurable: true,\n  });\n\n  //babelHelpers.bind\n  let functionBind = Get(realm, realm.intrinsics.FunctionPrototype, \"bind\");\n\n  babelHelpersValue.$DefineOwnProperty(\"bind\", {\n    value: functionBind,\n    writable: true,\n    enumerable: true,\n    configurable: true,\n  });\n\n  global.$DefineOwnProperty(\"babelHelpers\", {\n    value: babelHelpersValue,\n    writable: true,\n    enumerable: true,\n    configurable: true,\n  });\n  babelHelpersValue.refuseSerialization = false;\n}\n\nfunction createMagicGlobalFunction(realm: Realm, global: ObjectValue | AbstractObjectValue, functionName: string) {\n  global.$DefineOwnProperty(functionName, {\n    value: new NativeFunctionValue(realm, functionName, functionName, 0, (context, args) => {\n      let val = AbstractValue.createTemporalFromBuildFunction(\n        realm,\n        FunctionValue,\n        args,\n        _args => t.callExpression(t.identifier(functionName), ((_args: any): Array<any>)),\n        { skipInvariant: true, isPure: true }\n      );\n      invariant(val instanceof AbstractValue);\n      return val;\n    }),\n    writable: true,\n    enumerable: false,\n    configurable: true,\n  });\n}\n\nfunction createMagicGlobalObject(realm: Realm, global: ObjectValue | AbstractObjectValue, objectName: string) {\n  let globalObject = AbstractValue.createAbstractObject(realm, objectName);\n  globalObject.kind = \"resolved\";\n\n  global.$DefineOwnProperty(objectName, {\n    value: globalObject,\n    writable: true,\n    enumerable: false,\n    configurable: true,\n  });\n}\n\nfunction createBootloader(realm: Realm, global: ObjectValue | AbstractObjectValue) {\n  let bootloader = new ObjectValue(realm, realm.intrinsics.ObjectPrototype);\n\n  let loadModules = new NativeFunctionValue(realm, \"loadModules\", \"loadModules\", 1, (context, args) => {\n    invariant(context.$Realm.generator);\n    let val = AbstractValue.createTemporalFromBuildFunction(\n      realm,\n      FunctionValue,\n      args,\n      _args =>\n        t.callExpression(\n          t.memberExpression(t.identifier(\"Bootloader\"), t.identifier(\"loadModules\")),\n          ((_args: any): Array<any>)\n        ),\n      { skipInvariant: true }\n    );\n    invariant(val instanceof AbstractValue);\n    return val;\n  });\n\n  Properties.Set(realm, bootloader, \"loadModules\", loadModules, false);\n\n  global.$DefineOwnProperty(\"Bootloader\", {\n    value: bootloader,\n    writable: true,\n    enumerable: false,\n    configurable: true,\n  });\n\n  return AbstractValue.createAbstractObject(realm, \"Bootloader\", bootloader);\n}\n\nexport function createFbMocks(realm: Realm, global: ObjectValue | AbstractObjectValue): void {\n  global.$DefineOwnProperty(\"__DEV__\", {\n    // TODO: we'll likely want to make this configurable from the outside.\n    value: realm.intrinsics.false,\n    writable: true,\n    enumerable: false,\n    configurable: true,\n  });\n\n  createBabelHelpers(realm, global);\n\n  for (let functionName of fbMagicGlobalFunctions) {\n    createMagicGlobalFunction(realm, global, functionName);\n  }\n\n  for (let objectName of fbMagicGlobalObjects) {\n    createMagicGlobalObject(realm, global, objectName);\n  }\n  createBootloader(realm, global);\n}\n"]}